---
description: User-friendly console output patterns for CLI commands with clear status messaging
globs:
  - "manchego/cli/**/*.py"
alwaysApply: false
---

# CLI Output Standards

- Show user-friendly summaries with emoji indicators (üîÑ, ‚úÖ, ‚ö†Ô∏è, ‚ùå)
- Use `typer.echo()` for all console output, never `print()`
- Distinguish between dry-run previews and actual operations
- Show progress indicators for long operations
- Display structured summaries (created/skipped/failed counts)
- Use `err=True` for error messages sent to stderr
- Catch exceptions and show user-friendly error messages
- Console output is for users; file logs are for agents (see rule 609)

## Examples

‚ùå **Avoid:**
```python
print(f"Processed: {stats['created']} Skipped: {stats['skipped']}")
typer.echo("Error: PIL.UnidentifiedImageError: cannot identify image file")
```

‚úÖ **Prefer:**
```python
if stats['created'] > 0:
    typer.echo(f"‚úÖ Created {stats['created']} processed receipts")
if stats['failed'] > 0:
    typer.echo(f"‚ö†Ô∏è {stats['failed']} files failed (check logs for details)")
typer.echo(f"‚ùå Processing failed: {e}", err=True)
```

‚ùå **Avoid:**
```python
def cli_preprocess():
    stats = preprocess_all()
    typer.echo(f"Done: {stats}")
```

‚úÖ **Prefer:**
```python
def cli_preprocess():
    try:
        typer.echo("üîÑ Starting receipt preprocessing...")
        stats = preprocess_all()
        # User-friendly summary with conditional messages
        if stats['created'] > 0:
            typer.echo(f"‚úÖ Created {stats['created']} processed receipts")
        typer.echo(f"‚è±Ô∏è Total time: {stats['elapsed_s']}s")
    except Exception as e:
        typer.echo(f"‚ùå Preprocessing failed: {e}", err=True)
        raise typer.Exit(1) from e
```

## See Also

- **Rule 609**: Console vs File Logging (explains the separation between user-friendly console output and machine-readable file logs)
